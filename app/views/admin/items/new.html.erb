<p>商品新規登録</p>
<%= form_for [:admin, @item] do |f| %>
<div>
    <div>
        <label>商品画像</label>
        <div class="item-image">
        <%= attachment_image_tag @item, :image, class: "img-square", fallback: "img/no_image.jpg", size:"300x300" %>
      　</div>
        <%= f.attachment_field :image %>
    </div>
</div>
<div>
    <div>
        <label>商品名</label>
        <%= f.text_field :name %>
    </div>
    <div>
        <label>商品説明</label>
        <%= f.text_area :introduction %>
    </div>
    <div>
        <label>ジャンル</label>
        <%= f.collection_select(:name, Genre.all, :id, :name, promote: "選択してください") %>
    </div>
    <div>
        <label>税抜価格</label>
        <%= f.number_field :price %>円
    </div>
    <div>
        <label>販売ステータス</label>
        <%= f.select :sales_status, Item.sales_statuses.keys.to_a, {class: 'form-control'} %>
        
    </div>
</div>
<div>
    <%= f.submit %>
</div>
<% end %>



<script type="text/javascript">
$(function(){
    // inputのidから情報の取得
    $('#item_image').on('change', function (e) {
// ここから既存の画像のurlの取得
    var reader = new FileReader();
    reader.onload = function (e) {
        console.log(e.target.result)
        $(".image").attr('src', e.target.result);
    }
// ここまで
    reader.readAsDataURL(e.target.files[0]); //取得したurlにアップロード画像のurlを挿入
});
});

</script>
